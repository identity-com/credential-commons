"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),uuid=require("uuid/v4"),logger=require("../logger");function DummyAnchorServiceImpl(a,b){var c=this;this.config=a,this.http=b;var d=function(){var a=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function b(a){var e;return _regenerator.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,c.http.request({url:a,method:"GET",simple:!0,json:!0});case 3:if(e=b.sent,e&&e.type){b.next=8;break}return b.next=7,d(a);case 7:return b.abrupt("return",b.sent);case 8:if(!(e&&"permanent"!==e.type)){b.next=11;break}return e.statusUrl=a,b.abrupt("return",e);case 11:return b.abrupt("return",e);case 14:throw b.prev=14,b.t0=b["catch"](0),logger.error("Error polling: ".concat(a),JSON.stringify(b.t0,null,2)),new Error("Error polling: ".concat(a));case 18:case"end":return b.stop();}},b,null,[[0,14]])}));return function(){return a.apply(this,arguments)}}();return this.anchor=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function a(){var b,c=arguments;return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=0<c.length&&void 0!==c[0]?c[0]:{},a.abrupt("return",Promise.resolve({subject:{pub:"xpub:dummy",label:b.subject&&b.subject.label?b.subject.label:null,data:b.subject&&b.subject.data?b.subject.data:null,signature:"signed:dummy"},walletId:"none",cosigners:[{pub:"xpub:dummy"},{pub:"xpub:dummy"}],authority:{pub:"xpub:dummy",path:"/"},coin:"dummycoin",tx:new uuid,network:"dummynet",type:"temporary",civicAsPrimary:!1,schema:"dummy-20180201"}));case 2:case"end":return a.stop();}},a)})),this.update=function(){var a=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function b(a){return _regenerator.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a.type="permanent",a.value=uuid(),b.abrupt("return",Promise.resolve(a));case 3:case"end":return b.stop();}},b)}));return function(){return a.apply(this,arguments)}}(),this.verifySignature=function(){return!0},this.verifySubjectSignature=function(){return!0},this.verifyAttestation=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function a(){return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!0);case 1:case"end":return a.stop();}},a)})),this.revokeAttestation=function(){var a=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function b(a){return _regenerator.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return a.revoked=!0,b.abrupt("return",Promise.resolve(a));case 2:case"end":return b.stop();}},b)}));return function(){return a.apply(this,arguments)}}(),this.isRevoked=function(a){return!!a.revoked&&a.revoked},this}module.exports={CurrentCivicAnchor:DummyAnchorServiceImpl};