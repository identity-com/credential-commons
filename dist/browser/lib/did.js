"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_require=require("@digitalbazaar/did-io"),_findVerificationMethod=_require.findVerificationMethod,CachedResolver=_require.CachedResolver,didSol=require("@identity.com/did-io-driver-sol").default,resolver=new CachedResolver;resolver.use(didSol.driver({payer:null})),module.exports={canSign:function(a,b){var c=this;return(0,_asyncToGenerator2.default)(_regenerator.default.mark(function d(){var e,f,g,h,i,j;return _regenerator.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e=b.split("#"),f=(0,_slicedToArray2.default)(e,1),g=f[0],!a.id){d.next=5;break}d.t0=a,d.next=8;break;case 5:return d.next=7,c.resolve(a);case 7:d.t0=d.sent;case 8:if(h=d.t0,i=h.id,g!==i){d.next=12;break}return d.abrupt("return",null!==c.findVerificationMethod(h,b));case 12:if(h.controller.includes(g)){d.next=14;break}return d.abrupt("return",!1);case 14:return d.next=16,c.resolve(g);case 16:return j=d.sent,d.abrupt("return",null!==c.findVerificationMethod(j,b));case 18:case"end":return d.stop();}},d)}))()},resolve:function(a){return(0,_asyncToGenerator2.default)(_regenerator.default.mark(function b(){return _regenerator.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",resolver.get({did:a}));case 1:case"end":return b.stop();}},b)}))()},findVerificationMethod:function(a,b){return a.keyAgreement&&0<a.keyAgreement.length?a.keyAgreement.find(function(a){return a.id===b}):a.capabilityInvocation.includes(b)?_findVerificationMethod({doc:a,methodId:b}):null}};