"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_=require("lodash"),validateEmptyParametersOperators=function(a){if(!_.isEmpty(a))throw new Error("parameters should be empty");return!0},validateNotEmptyParametersOperators=function(a){if(!a&&_.isEmpty(a))throw new Error("parameters should not be empty");return!0},validatePathParametersOperators=function(a){if(!_.isString(a))throw new Error("parameters should be string");return!0},validateNumberParametersOperators=function(a){if(!_.isNumber(a))throw new Error("parameters should be number");return!0},validateObjectParametersOperators=function(a){if(!_.isObject(a))throw new Error("parameters should be object");return!0},sort=function(a,b){var c=_.keys(b)[0],d=b[c],e=_.sortBy(a,c);return"ASC"===d?e:_.reverse(e)},AGGREGATION_OPERATORS_MAP={none:function(a,b){return validateEmptyParametersOperators(b)?(0,_toConsumableArray2.default)(a):null},$limit:function(a,b){return validateNumberParametersOperators(b)?(0,_toConsumableArray2.default)(_.slice(a,0,b)):null},$min:function(a,b){return validatePathParametersOperators(b)?[_.minBy(a,b)]:null},$max:function(a,b){return validatePathParametersOperators(b)?[_.maxBy(a,b)]:null},$first:function(a,b){return validateNotEmptyParametersOperators(b)?[_.first(a)]:null},$last:function(a,b){return validateNotEmptyParametersOperators(b)?[_.last(a)]:null},$sort:function(a,b){return validateObjectParametersOperators(b)?(0,_toConsumableArray2.default)(sort(a,b)):null}};function aggregate(a,b){var c=(0,_toConsumableArray2.default)(a);return _.forEach(b,function(a){var b=_.keys(a)[0];if(!_.includes(_.keys(AGGREGATION_OPERATORS_MAP),b))throw new Error("Invalid operator: ".concat(b));var d=a[b],e=AGGREGATION_OPERATORS_MAP[b];c=e(c,d)}),c}module.exports=aggregate;